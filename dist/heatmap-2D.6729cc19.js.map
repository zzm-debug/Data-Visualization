{"version":3,"sources":["heatmap-2D.js"],"names":["init2DHeatmap","container","document","getElementById","console","error","containerId","id","d3","select","concat","selectAll","remove","csvData","data","csvParse","trim","genres","months","map","d","heatmapData","flatMap","row","genre","month","value","heatmapContainer","containerWidth","clientWidth","containerHeight","clientHeight","margin","top","Math","max","right","bottom","left","width","height","root","append","attr","svg","x","scaleBand","range","domain","padding","y","css","getComputedStyle","documentElement","axisColor","getPropertyValue","gridColor","cssVar","name","fallback","accentBlue","accentViolet","accentPink","accentCyan","xAxis","call","axisBottom","tickSizeOuter","length","style","yAxis","axisLeft","vMin","min","vMax","cyberStops","cyberInterpolator","interpolateRgbBasis","colorScale","scaleSequential","interpolator","updateLegend","legend","fmt","format","innerHTML","join","tooltip","enter","bandwidth","on","event","html","pageX","pageY","defs","glow","feMerge","genreCenter","line","curve","curveMonotoneX","lineData1","lineData2","linePoints1","i","top_genre","count","linePoints2","theme","ink","lineA","lineB","dotFill","drawTrend","points","color","cls","datum","log","window","waitForContainer","offsetWidth","offsetHeight","display","setTimeout","readyState","addEventListener"],"mappings":"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","file":"heatmap-2D.6729cc19.js","sourceRoot":"..\\src","sourcesContent":["// heatmap-2D.js - 2Dçƒ­åŠ›å›¾\n// âœ… Inline CSV data (for heatmap)\n(() => {\n  // ç­‰å¾…DOMåŠ è½½å®Œæˆ\n  const init2DHeatmap = () => {\n    // ä½¿ç”¨ heatmap-2d å®¹å™¨\n    const container = document.getElementById(\"heatmap-2d\") || document.getElementById(\"heatmap\");\n    if (!container) {\n      console.error('âŒ æ‰¾ä¸åˆ°heatmapå®¹å™¨');\n      return;\n    }\n    \n    // ä½¿ç”¨å®¹å™¨çš„IDè¿›è¡Œé€‰æ‹©\n    const containerId = container.id;\n    d3.select(`#${containerId}`).selectAll(\"*\").remove();\n    d3.select(\"body\").selectAll(\".heatmap-tooltip\").remove();\n\n    const csvData = `month,classical,electronic,folk,jazz,pop,rock,ACG,rap\n2023-12,35,34,64,47,24,32,37,37\n2024-01,35,33,58,46,23,31,32,36\n2024-02,34,32,62,48,26,33,34,39\n2024-03,35,34,59,48,23,34,37,38\n2024-04,31,34,55,47,21,34,31,36\n2024-05,32,48,57,46,24,34,32,38\n2024-06,32,49,62,48,23,36,31,40\n2024-07,31,38,64,49,25,32,31,38\n2024-08,30,39,62,46,23,32,32,37\n2024-09,32,35,60,45,23,36,33,45\n2024-10,31,32,60,49,23,33,31,46\n2024-11,35,33,58,45,22,32,32,39\n2024-12,35,35,63,48,23,33,37,39\n2025-01,32,34,54,47,22,32,32,38\n2025-02,33,33,58,48,22,31,29,42\n2025-03,33,32,56,48,22,31,31,36\n2025-04,31,33,59,45,22,31,30,36\n2025-05,30,37,58,46,23,32,30,39\n2025-06,29,33,57,46,21,32,31,36\n2025-07,29,36,60,48,21,39,31,38\n2025-08,31,35,59,46,22,34,31,34\n2025-09,30,32,61,46,22,33,30,32\n2025-10,33,33,59,44,21,34,31,36\n2025-11,31,32,57,46,21,33,30,33\n2025-12,33,32,60,45,23,32,33,39\n`;\n\n  const data = d3.csvParse(csvData.trim());\n\n  // âœ… Genre keysï¼ˆä¸ä½ åŸé€»è¾‘ä¸€è‡´ï¼‰\n  const genres = [\"ACG\", \"classical\", \"electronic\", \"folk\", \"jazz\", \"pop\", \"rap\", \"rock\"];\n  const months = data.map(d => d[\"month\"]);\n\n  const heatmapData = data.flatMap(row =>\n    genres.map(genre => ({\n      month: row[\"month\"],\n      genre,\n      value: +row[genre]\n    }))\n  );\n\n  // === è‡ªé€‚åº”å°ºå¯¸è®¡ç®— ===\n  // ä½¿ç”¨ä¸ä¸Šé¢ç›¸åŒçš„å®¹å™¨\n  const heatmapContainer = container;\n  const containerWidth = heatmapContainer.clientWidth || 900;\n  const containerHeight = heatmapContainer.clientHeight || 320;\n\n  const margin = {\n    top: Math.max(22, containerHeight * 0.10),\n    right: Math.max(18, containerWidth * 0.03),\n    bottom: Math.max(46, containerHeight * 0.18),\n    left: Math.max(64, containerWidth * 0.10)\n  };\n\n  const width = containerWidth - margin.left - margin.right;\n  const height = containerHeight - margin.top - margin.bottom;\n\n  const root = d3.select(`#${containerId}`)\n    .append(\"svg\")\n    .attr(\"width\", \"100%\")\n    .attr(\"height\", \"100%\")\n    .attr(\"viewBox\", `0 0 ${containerWidth} ${containerHeight}`)\n    .attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n\n  // âœ… èƒŒæ™¯â€œå¡ç‰‡å†…è¡¬â€ï¼ˆæ·±è‰²èµ›åšä¸»é¢˜ä¸‹ä¿æŒå…‹åˆ¶ï¼Œä¸æŠ¢è‰²å—ï¼‰\n  root.append(\"rect\")\n    .attr(\"x\", 10)\n    .attr(\"y\", 10)\n    .attr(\"width\", containerWidth - 20)\n    .attr(\"height\", containerHeight - 20)\n    .attr(\"rx\", 14)\n    .attr(\"ry\", 14)\n    .attr(\"fill\", \"rgba(7, 3, 18, 0.18)\")\n    .attr(\"stroke\", \"rgba(50, 167, 255, 0.16)\");\n\n  const svg = root.append(\"g\")\n    .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n\n  // === Axes ===\n  const x = d3.scaleBand().range([0, width]).domain(months).padding(0.08);\n  const y = d3.scaleBand().range([height, 0]).domain(genres).padding(0.10);\n\n  const css = getComputedStyle(document.documentElement);\n  const axisColor = (css.getPropertyValue(\"--axis-text-strong\") || \"\").trim() || \"rgba(226, 232, 240, 0.88)\";\n  const gridColor = (css.getPropertyValue(\"--axis-grid\") || \"\").trim() || \"rgba(50, 167, 255, 0.12)\";\n\n  const cssVar = (name, fallback) => (css.getPropertyValue(name) || \"\").trim() || fallback;\n  const accentBlue = cssVar(\"--accent-blue\", \"#32a7ff\");\n  const accentViolet = cssVar(\"--accent-violet\", \"#7c3aed\");\n  const accentPink = cssVar(\"--accent-pink\", \"#ff3bd4\");\n  const accentCyan = cssVar(\"--accent-cyan\", \"#00fff0\");\n\n  const xAxis = svg.append(\"g\")\n    .attr(\"transform\", `translate(0, ${height})`)\n    .call(d3.axisBottom(x).tickSizeOuter(0));\n\n  if (months.length > 12 || containerWidth < 560) {\n    xAxis.selectAll(\"text\")\n      .attr(\"transform\", \"rotate(-45)\")\n      .style(\"text-anchor\", \"end\")\n      .attr(\"dx\", \"-0.45em\")\n      .attr(\"dy\", \"0.55em\");\n  }\n\n  xAxis.selectAll(\"path, line\").attr(\"stroke\", \"rgba(50, 167, 255, 0.26)\");\n  xAxis.selectAll(\"text\")\n    .attr(\"fill\", axisColor)\n    .style(\"font-size\", \"12px\")\n    .style(\"paint-order\", \"stroke\")\n    .style(\"stroke\", \"rgba(7, 3, 18, 0.72)\")\n    .style(\"stroke-width\", \"2.0px\")\n    .style(\"stroke-linejoin\", \"round\");\n\n  const yAxis = svg.append(\"g\")\n    .call(d3.axisLeft(y).tickSizeOuter(0));\n\n  yAxis.selectAll(\"path, line\").attr(\"stroke\", \"rgba(50, 167, 255, 0.26)\");\n  yAxis.selectAll(\"text\")\n    .attr(\"fill\", axisColor)\n    .style(\"font-size\", \"12px\")\n    .style(\"paint-order\", \"stroke\")\n    .style(\"stroke\", \"rgba(7, 3, 18, 0.72)\")\n    .style(\"stroke-width\", \"2.0px\")\n    .style(\"stroke-linejoin\", \"round\");\n\n  // === âœ… é¢œè‰²ï¼šèµ›åšéœ“è™¹æ¸å˜ï¼ˆä¸é¡µé¢ä¸»é¢˜è‰²ä¸€è‡´ï¼‰ ===\n  const vMin = d3.min(heatmapData, d => d.value);\n  const vMax = d3.max(heatmapData, d => d.value);\n\n  // èµ›åšæ¸å˜ï¼šè¿›ä¸€æ­¥æäº®ä¸‹ç•Œï¼Œå¹¶é™ä½ç²‰è‰²æ®µå¼ºåº¦ï¼ˆé¿å… pop è¡Œè¿‡äºçªå‡ºï¼‰\n  // æ¸å˜æ®µæ•°æ”¶æ•›åˆ° 4 æ®µï¼šæ•´ä½“æ›´â€œè¿ç»­â€ï¼ŒåŒæ—¶ä¿æŒä½å€¼ä¸é»‘ã€é«˜å€¼ç«¯å¸¦ä¸€ç‚¹ç²‰\n  const cyberStops = [\n    \"#3a2a6d\",   // æ›´äº®çš„æ·±ç´«åº•ï¼ˆä½å€¼ä¸é»‘ï¼‰\n    accentBlue,  // éœ“è™¹è“ï¼ˆä¸­ä½å€¼ä¸»è‰²ï¼‰\n    accentCyan,  // ç”µé’ï¼ˆä¸­é«˜å€¼ï¼‰\n    \"#ff5adf\"    // æŸ”ç²‰ï¼ˆä»…æœ€é«˜å€¼ç«¯å‡ºç°ï¼‰\n  ];\n  const cyberInterpolator = d3.interpolateRgbBasis(cyberStops);\n\n  const colorScale = d3.scaleSequential()\n    .domain([vMin, vMax])\n    .interpolator(cyberInterpolator);\n\n  // === é¢œè‰²æ˜ å°„å›¾ä¾‹ï¼ˆ2D/3D å…±ç”¨å®¹å™¨ï¼‰===\n  (function updateLegend() {\n    const legend = document.getElementById(\"heatmap-color-legend\");\n    if (!legend) return;\n    const fmt = d3.format(\",d\");\n    legend.innerHTML = `\n      <div class=\"legend-title\">Score â†’ Color</div>\n      <div class=\"legend-bar\" style=\"background: linear-gradient(90deg, ${cyberStops.join(\",\")});\"></div>\n      <div class=\"legend-labels\">\n        <span>${fmt(vMin ?? 0)}</span>\n        <span>${fmt(vMax ?? 0)}</span>\n      </div>\n    `;\n  })();\n\n  // === Tooltip ===\n  const tooltip = d3.select(\"body\").append(\"div\")\n    .attr(\"class\", \"heatmap-tooltip\")\n    .style(\"position\", \"absolute\")\n    .style(\"pointer-events\", \"none\")\n    .style(\"opacity\", 0)\n    .style(\"padding\", \"10px 12px\")\n    .style(\"border-radius\", \"12px\")\n    .style(\"background\", \"rgba(30,41,59,0.92)\")\n    .style(\"color\", \"#fff\")\n    .style(\"font\", '13px/1.35 system-ui,-apple-system,\"Segoe UI\",\"Microsoft YaHei\",sans-serif')\n    .style(\"box-shadow\", \"0 10px 24px rgba(0,0,0,0.16)\");\n\n  // === Heatmap cells ===\n  svg.selectAll(\"rect.cell\")\n    .data(heatmapData)\n    .enter()\n    .append(\"rect\")\n    .attr(\"class\", \"cell\")\n    .attr(\"x\", d => x(d.month))\n    .attr(\"y\", d => y(d.genre))\n    .attr(\"width\", x.bandwidth())\n    .attr(\"height\", y.bandwidth())\n    .attr(\"rx\", 8)\n    .attr(\"ry\", 8)\n    .attr(\"fill\", d => colorScale(d.value))\n    .attr(\"stroke\", gridColor)\n    .attr(\"stroke-width\", 1)\n    .on(\"mousemove\", (event, d) => {\n      tooltip\n        .style(\"opacity\", 1)\n        .html(`<b>${d.genre}</b><br/>${d.month}<br/>Value: ${d.value}`)\n        .style(\"left\", `${event.pageX + 12}px`)\n        .style(\"top\", `${event.pageY - 18}px`);\n    })\n    .on(\"mouseout\", () => tooltip.style(\"opacity\", 0));\n\n  // === âœ… æŠ˜çº¿æ›´æŸ”å’Œï¼šé¢œè‰²ç»Ÿä¸€ã€çº¿æ›´ç»†ã€è½»å¾®å…‰æ™•ï¼Œç‚¹ç”¨â€œç©ºå¿ƒæè¾¹â€é¿å…ç™½ç‚¹çªå…€ ===\n  // Glow filter\n  const defs = root.append(\"defs\");\n  const glow = defs.append(\"filter\").attr(\"id\", \"heatmapGlow\");\n  glow.append(\"feGaussianBlur\").attr(\"stdDeviation\", \"1.8\").attr(\"result\", \"coloredBlur\");\n  const feMerge = glow.append(\"feMerge\");\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"coloredBlur\");\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\");\n\n  const genreCenter = d => y(d.genre) + y.bandwidth() / 2;\n\n  const line = d3.line()\n    .x(d => x(d.month) + x.bandwidth() / 2)\n    .y(d => genreCenter(d))\n    .curve(d3.curveMonotoneX);\n\n  // æ•°æ®ä¿æŒä½ çš„åŸå§‹é€»è¾‘ï¼ˆåªæ˜¯æ¢é¢œè‰²/æ ·å¼ï¼‰\n  const lineData1 = [\n    {\"part\": 1, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 2, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 3, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 4, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 5, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 6, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 7, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 8, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 9, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 10, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 11, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 12, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 13, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 14, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 15, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 16, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 17, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 18, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 19, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 20, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 21, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 22, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 23, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 24, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 25, \"top_genre\": \"pop\", \"count\": 6}\n  ];\n\n  const lineData2 = [\n    {\"part\": 1, \"top_genre\": \"rap\", \"count\": 5},\n    {\"part\": 2, \"top_genre\": \"rap\", \"count\": 6},\n    {\"part\": 3, \"top_genre\": \"rap\", \"count\": 7},\n    {\"part\": 4, \"top_genre\": \"rap\", \"count\": 6},\n    {\"part\": 5, \"top_genre\": \"rap\", \"count\": 7},\n    {\"part\": 6, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 7, \"top_genre\": \"pop\", \"count\": 8},\n    {\"part\": 8, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 9, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 10, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 11, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 12, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 13, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 14, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 15, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 16, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 17, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 18, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 19, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 20, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 21, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 22, \"top_genre\": \"pop\", \"count\": 7},\n    {\"part\": 23, \"top_genre\": \"pop\", \"count\": 6},\n    {\"part\": 24, \"top_genre\": \"pop\", \"count\": 5},\n    {\"part\": 25, \"top_genre\": \"pop\", \"count\": 5}\n  ];\n\n  const linePoints1 = lineData1.map((d, i) => ({ month: months[i], genre: d.top_genre, count: +d.count }));\n  const linePoints2 = lineData2.map((d, i) => ({ month: months[i], genre: d.top_genre, count: +d.count }));\n\n  const theme = {\n    ink: \"rgba(36,52,71,0.70)\",\n    // å‚è€ƒå›¾äºŒï¼šè“ç° + è±†æ²™ï¼ˆæ›´ç»Ÿä¸€ï¼‰\n    lineA: \"#5B7AA6\",\n    lineB: \"#C97A6E\",\n    dotFill: \"#F7F4EC\"\n  };\n\n  function drawTrend(points, color, cls) {\n    svg.append(\"path\")\n      .datum(points)\n      .attr(\"class\", cls)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", color)\n      .attr(\"stroke-width\", 2.2)\n      .attr(\"stroke-linejoin\", \"round\")\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"opacity\", 0.95)\n      .attr(\"filter\", \"url(#heatmapGlow)\")\n      .attr(\"d\", line);\n\n    svg.selectAll(`circle.${cls}-pt`)\n      .data(points)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", `${cls}-pt`)\n      .attr(\"cx\", d => x(d.month) + x.bandwidth() / 2)\n      .attr(\"cy\", d => genreCenter(d))\n      .attr(\"r\", d => 3.2 + d.count / 6)   // æ›´å…‹åˆ¶\n      .attr(\"fill\", theme.dotFill)         // ç©ºå¿ƒæ•ˆæœæ›´å¹²å‡€\n      .attr(\"stroke\", color)\n      .attr(\"stroke-width\", 2)\n      .attr(\"opacity\", 0.95)\n      .on(\"mousemove\", (event, d) => {\n        tooltip\n          .style(\"opacity\", 1)\n          .html(`ğŸµ Genre: <b>${d.genre}</b><br/>${d.month}<br/>Count: ${d.count}`)\n          .style(\"left\", `${event.pageX + 12}px`)\n          .style(\"top\", `${event.pageY - 18}px`);\n      })\n      .on(\"mouseout\", () => tooltip.style(\"opacity\", 0));\n  }\n\n    drawTrend(linePoints1, theme.lineA, \"trendA\");\n    drawTrend(linePoints2, theme.lineB, \"trendB\");\n\n    console.log(\"âœ… 2D Heatmap rendered (Morandi cool-warm + softer trends)\");\n  };\n  \n  // å¯¼å‡ºåˆå§‹åŒ–å‡½æ•°ï¼Œå…è®¸å¤–éƒ¨è°ƒç”¨\n  window.init2DHeatmap = init2DHeatmap;\n  \n  // ç­‰å¾…å®¹å™¨æœ‰å°ºå¯¸åå†æ‰§è¡Œ\n  // ç®€åŒ–ï¼šå¦‚æœå®¹å™¨è¢«éšè—ï¼Œä½¿ç”¨é»˜è®¤å°ºå¯¸ç»§ç»­\n  const waitForContainer = () => {\n    const container = document.getElementById(\"heatmap-2d\") || document.getElementById(\"heatmap\");\n    if (!container) {\n      console.error('âŒ æ‰¾ä¸åˆ°heatmapå®¹å™¨');\n      return;\n    }\n    \n    const width = container.offsetWidth || container.clientWidth;\n    const height = container.offsetHeight || container.clientHeight;\n    \n    // å¦‚æœå®¹å™¨æœ‰å°ºå¯¸ï¼Œæˆ–è€…å®¹å™¨è¢«éšè—ï¼ˆä½¿ç”¨é»˜è®¤å°ºå¯¸ï¼‰\n    if (width > 0 && height > 0) {\n      init2DHeatmap();\n    } else if (container.style.display === 'none') {\n      // å¦‚æœå®¹å™¨è¢«éšè—ï¼Œä½¿ç”¨é»˜è®¤å°ºå¯¸ç»§ç»­\n      console.log('âš ï¸ å®¹å™¨è¢«éšè—ï¼Œä½¿ç”¨é»˜è®¤å°ºå¯¸ç»§ç»­');\n      init2DHeatmap();\n    } else {\n      setTimeout(waitForContainer, 100);\n    }\n  };\n  \n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      setTimeout(waitForContainer, 100);\n    });\n  } else {\n    setTimeout(waitForContainer, 100);\n  }\n})();\n"]}