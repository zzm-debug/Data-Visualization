{"version":3,"sources":["heatmap-2D.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["cssVar","name","fallback","v","getComputedStyle","document","documentElement","getPropertyValue","trim","getCyberStops","ensureHeatmapOverlay","container","stage","closest","parentElement","style","position","styleId","getElementById","createElement","id","textContent","head","appendChild","anno","querySelector","className","open","innerHTML","addEventListener","e","stopPropagation","borderRadius","overflow","background","border","boxShadow","init2DHeatmap","console","error","containerId","d3","select","concat","selectAll","remove","csvData","data","csvParse","genres","months","map","d","heatmapData","flatMap","row","genre","month","value","heatmapContainer","containerWidth","clientWidth","containerHeight","clientHeight","margin","top","Math","max","right","bottom","left","width","height","root","append","attr","svg","x","scaleBand","range","domain","padding","y","css","axisColor","gridColor","xAxis","call","axisBottom","tickSizeOuter","length","yAxis","axisLeft","vMin","min","vMax","cyberStops","cyberInterpolator","interpolateRgbBasis","colorScale","scaleSequential","interpolator","updateLegend","legend","fmt","format","join","tooltip","empty","enter","bandwidth","on","event","html","cx","clientX","pageX","cy","clientY","pageY","node","w","offsetWidth","h","offsetHeight","pad","tx","ty","window","innerWidth","innerHeight","log","waitForContainer","display","setTimeout","readyState","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","body","stackTrace","innerText","getParents","modules","parents","k","dep","Array","isArray","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"heatmap-2D.c8aec00e.js","sourceRoot":"..\\src","sourcesContent":["// heatmap-2D.js - 2Dçƒ­åŠ›å›¾ï¼ˆå·²å»é™¤æŠ˜çº¿è¶‹åŠ¿å›¾ï¼‰\n// âœ… Inline CSV data (for heatmap)\n(() => {\n  //#region Heatmap 2Dï½œä¸»é¢˜/è£…é¥°å±‚ï¼ˆåªä¿ç•™åŸå›¾æ³¨é‡Šï¼Œä¸é¢å¤–åŠ  2D/3D å¾½æ ‡ï¼‰\n  /**\n   * è¯´æ˜ï¼š\n   * - ä½ çš„æˆªå›¾é‡Œçƒ­åŠ›å›¾é¢æ¿æœ‰â€œèµ›åšéœ“è™¹æ¸å˜ + ç»ç’ƒè´¨æ„Ÿå¡ç‰‡ + å·¦ä¸‹è§’å¯æŠ˜å è¯´æ˜ + å³ä¸Šè§’ 3D/2D å¾½æ ‡â€ã€‚\n   * - è¿™é‡Œä¸æ”¹æ•´ä½“é¡µé¢å¸ƒå±€ï¼ˆ`index.html`ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡ JS è¿è¡Œæ—¶æ³¨å…¥â€œè£…é¥°å±‚â€å’Œæ ·å¼ï¼Œ\n   *   ä¿è¯ 2D/3D åˆ‡æ¢æ—¶ä¸¤å¥—å›¾ä¸€è‡´ï¼Œä¸”ç‚¹å‡»æ‰“å¼€çš„æ–°çª—å£å¤§å›¾ä¹Ÿèƒ½å¤ç”¨åŒä¸€å¥—æ–‡æ¡ˆ/é£æ ¼ã€‚\n   */\n\n  function cssVar(name, fallback) {\n    const v = getComputedStyle(document.documentElement).getPropertyValue(name);\n    return (v || \"\").trim() || fallback;\n  }\n\n  /** âœ… æ¸å˜ï¼šæŒ‰ä½ åŸå›¾çš„ç´«ç™½å•è‰²ç³»ï¼ˆä¸æ··é’/ç²‰ï¼‰ */\n  function getCyberStops() {\n    // âœ… åŸå›¾ legendï¼šç”±æµ…å…¥æ·±ï¼ˆå·¦æµ…â†’å³æ·±ï¼‰\n    // å› æ­¤ï¼šmin â†’ æµ…è‰²ï¼Œmax â†’ æ·±è‰²\n    return [\"#ffffff\", \"#e9d5ff\", \"#a855f7\", \"#6b21a8\", \"#2e1065\"];\n  }\n\n  function ensureHeatmapOverlay(container) {\n    const stage = container && (container.closest(\".heatmap-stage\") || container.parentElement);\n    if (!stage) return;\n    stage.style.position = stage.style.position || \"relative\";\n\n    // æ³¨å…¥ä¸€æ¬¡æ ·å¼ï¼ˆä¸»é¡µé¢ï¼‰\n    const styleId = \"heatmap-overlay-style\";\n    if (!document.getElementById(styleId)) {\n      const style = document.createElement(\"style\");\n      style.id = styleId;\n      style.textContent = `\n        /* âœ… å·¦ä¸Šè§’æ³¨é‡Šï¼šæŒ‰åŸå›¾ */\n        .hm-anno{\n          position:absolute; left:12px; top:12px;\n          width: min(340px, 50%);\n          border-radius: 12px;\n          background: rgba(10, 5, 20, 0.85);\n          border: 1px solid rgba(124, 58, 237, 0.3);\n          box-shadow: 0 4px 16px rgba(0,0,0,0.4);\n          color: rgba(226,232,240,0.9);\n          backdrop-filter: blur(8px);\n          z-index: 6;\n          overflow:hidden;\n        }\n        .hm-anno > summary{\n          list-style:none;\n          cursor:pointer;\n          padding: 6px 8px;\n          font: 11px/1.1 system-ui,-apple-system,\"Segoe UI\",\"Microsoft YaHei\",sans-serif;\n          font-weight: 700;\n          letter-spacing: .5px;\n          user-select:none;\n          color: #fff;\n        }\n        .hm-anno > summary::-webkit-details-marker{ display:none; }\n        .hm-anno .hm-anno-body{\n          padding: 0 8px 8px 8px;\n          font: 10px/1.45 system-ui,-apple-system,\"Segoe UI\",\"Microsoft YaHei\",sans-serif;\n          color: rgba(226,232,240,0.85);\n        }\n      `;\n      document.head.appendChild(style);\n    }\n\n    // âœ… æ³¨é‡Šæ–‡æ¡ˆï¼šä¸¥æ ¼æŒ‰åŸå›¾ï¼Œä¸åŠ ä»»ä½•é¢å¤–è¯´æ˜\n    let anno = stage.querySelector(\".hm-anno\");\n    if (!anno) {\n      anno = document.createElement(\"details\");\n      anno.className = \"hm-anno\";\n      anno.open = true;\n      anno.innerHTML = `\n        <summary>æ³¨é‡Šï¼ˆç‚¹å‡»éšè—ï¼‰</summary>\n        <div class=\"hm-anno-body\">\n          <div>çƒ­åŠ›å›¾ï¼šä¸–ç•ŒèŒƒå›´éŸ³ä¹çƒ­åº¦å˜åŒ–</div>\n          <div>æŠ˜çº¿å›¾ï¼šå›½å†…ç½‘å‹å¬éŸ³ä¹çš„æ›²ç›®æ•°é‡å˜åŒ–</div>\n        </div>\n      `;\n      stage.appendChild(anno);\n    }\n    // âœ… å…³é”®ï¼šé˜»æ­¢ç‚¹å‡»æ³¨é‡Šæ¡†æ—¶å†’æ³¡åˆ° `.chart-content`ï¼ˆå¦åˆ™ä¼šè§¦å‘ svg-interaction çš„â€œç‚¹å‡»æ‰“å¼€å¤§å›¾â€ï¼‰\n    try {\n      anno.addEventListener(\"click\", (e) => e.stopPropagation());\n      anno.addEventListener(\"pointerdown\", (e) => e.stopPropagation());\n    } catch (e) {}\n\n    // å®¹å™¨â€œå¡ç‰‡å†…è¡¬â€è´¨æ„Ÿï¼ˆæˆªå›¾æ˜¯ç»ç’ƒ/éœ“è™¹è¾¹æ¡†ï¼‰\n    try {\n      container.style.borderRadius = \"14px\";\n      container.style.overflow = \"hidden\";\n      container.style.background = \"rgba(7, 3, 18, 0.18)\";\n      container.style.border = \"1px solid rgba(50, 167, 255, 0.16)\";\n      container.style.boxShadow = \"inset 0 0 0 1px rgba(255,255,255,0.03), 0 0 18px rgba(255,59,212,0.10), 0 0 24px rgba(50,167,255,0.08)\";\n    } catch (e) {\n      // ä¸å½±å“å›¾è¡¨æ¸²æŸ“\n    }\n  }\n  //#endregion\n\n  // ç­‰å¾…DOMåŠ è½½å®Œæˆ\n  const init2DHeatmap = () => {\n    // ä½¿ç”¨ heatmap-2d å®¹å™¨\n    const container = document.getElementById(\"heatmap-2d\") || document.getElementById(\"heatmap\");\n    if (!container) {\n      console.error('âŒ æ‰¾ä¸åˆ°heatmapå®¹å™¨');\n      return;\n    }\n\n    // âœ… è£…é¥°å±‚ï¼šåªä¿ç•™æ³¨é‡Š + å®¹å™¨è´¨æ„Ÿï¼ˆä¸å†é¢å¤–åŠ  2D/3D å¾½æ ‡ï¼‰\n    ensureHeatmapOverlay(container);\n    \n    // ä½¿ç”¨å®¹å™¨çš„IDè¿›è¡Œé€‰æ‹©\n    const containerId = container.id;\n    d3.select(`#${containerId}`).selectAll(\"*\").remove();\n    // âš ï¸ ä¸è¦å…¨å±€ removeï¼š3D/2D å…±äº« tooltipï¼Œå¦åˆ™ä¼šäº’ç›¸åˆ æ‰å¯¼è‡´â€œtooltip æ²¡äº†â€\n\n    const csvData = `month,classical,electronic,folk,jazz,pop,rock,ACG,rap\n2023-12,35,34,64,47,24,32,37,37\n2024-01,35,33,58,46,23,31,32,36\n2024-02,34,32,62,48,26,33,34,39\n2024-03,35,34,59,48,23,34,37,38\n2024-04,31,34,55,47,21,34,31,36\n2024-05,32,48,57,46,24,34,32,38\n2024-06,32,49,62,48,23,36,31,40\n2024-07,31,38,64,49,25,32,31,38\n2024-08,30,39,62,46,23,32,32,37\n2024-09,32,35,60,45,23,36,33,45\n2024-10,31,32,60,49,23,33,31,46\n2024-11,35,33,58,45,22,32,32,39\n2024-12,35,35,63,48,23,33,37,39\n2025-01,32,34,54,47,22,32,32,38\n2025-02,33,33,58,48,22,31,29,42\n2025-03,33,32,56,48,22,31,31,36\n2025-04,31,33,59,45,22,31,30,36\n2025-05,30,37,58,46,23,32,30,39\n2025-06,29,33,57,46,21,32,31,36\n2025-07,29,36,60,48,21,39,31,38\n2025-08,31,35,59,46,22,34,31,34\n2025-09,30,32,61,46,22,33,30,32\n2025-10,33,33,59,44,21,34,31,36\n2025-11,31,32,57,46,21,33,30,33\n2025-12,33,32,60,45,23,32,33,39\n`;\n\n    const data = d3.csvParse(csvData.trim());\n\n    // âœ… Genre keysï¼ˆä¸ä½ åŸé€»è¾‘ä¸€è‡´ï¼‰\n    const genres = [\"ACG\", \"classical\", \"electronic\", \"folk\", \"jazz\", \"pop\", \"rap\", \"rock\"];\n    const months = data.map(d => d[\"month\"]);\n\n    const heatmapData = data.flatMap(row =>\n      genres.map(genre => ({\n        month: row[\"month\"],\n        genre,\n        value: +row[genre]\n      }))\n    );\n\n    // === è‡ªé€‚åº”å°ºå¯¸è®¡ç®— ===\n    const heatmapContainer = container;\n    const containerWidth = heatmapContainer.clientWidth || 900;\n    const containerHeight = heatmapContainer.clientHeight || 320;\n\n    const margin = {\n      top: Math.max(22, containerHeight * 0.10),\n      right: Math.max(18, containerWidth * 0.03),\n      bottom: Math.max(46, containerHeight * 0.18),\n      left: Math.max(64, containerWidth * 0.10)\n    };\n\n    const width = containerWidth - margin.left - margin.right;\n    const height = containerHeight - margin.top - margin.bottom;\n\n    const root = d3.select(`#${containerId}`)\n      .append(\"svg\")\n      .attr(\"width\", \"100%\")\n      .attr(\"height\", \"100%\")\n      .attr(\"viewBox\", `0 0 ${containerWidth} ${containerHeight}`)\n      .attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n\n    // âœ… èƒŒæ™¯â€œå¡ç‰‡å†…è¡¬â€\n    root.append(\"rect\")\n      .attr(\"x\", 10)\n      .attr(\"y\", 10)\n      .attr(\"width\", containerWidth - 20)\n      .attr(\"height\", containerHeight - 20)\n      .attr(\"rx\", 14)\n      .attr(\"ry\", 14)\n      .attr(\"fill\", \"rgba(7, 3, 18, 0.18)\")\n      .attr(\"stroke\", \"rgba(50, 167, 255, 0.16)\");\n\n    const svg = root.append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n\n    // === Axes ===\n    const x = d3.scaleBand().range([0, width]).domain(months).padding(0.08);\n    const y = d3.scaleBand().range([height, 0]).domain(genres).padding(0.10);\n\n    //#region Heatmap 2Dï½œåæ ‡è½´ä¸»é¢˜è‰²ï¼ˆä¸æ•´ä½“èµ›åšä¸»é¢˜ä¸€è‡´ï¼‰\n    const css = getComputedStyle(document.documentElement);\n    const axisColor = (css.getPropertyValue(\"--axis-text-strong\") || \"\").trim() || \"rgba(226, 232, 240, 0.88)\";\n    const gridColor = (css.getPropertyValue(\"--axis-grid\") || \"\").trim() || \"rgba(50, 167, 255, 0.12)\";\n\n    //#endregion\n\n    const xAxis = svg.append(\"g\")\n      .attr(\"transform\", `translate(0, ${height})`)\n      .call(d3.axisBottom(x).tickSizeOuter(0));\n\n    if (months.length > 12 || containerWidth < 560) {\n      xAxis.selectAll(\"text\")\n        .attr(\"transform\", \"rotate(-45)\")\n        .style(\"text-anchor\", \"end\")\n        .attr(\"dx\", \"-0.45em\")\n        .attr(\"dy\", \"0.55em\");\n    }\n\n    xAxis.selectAll(\"path, line\").attr(\"stroke\", \"rgba(50, 167, 255, 0.26)\");\n    xAxis.selectAll(\"text\")\n      .attr(\"fill\", axisColor)\n      .style(\"font-size\", \"12px\")\n      .style(\"paint-order\", \"stroke\")\n      .style(\"stroke\", \"rgba(7, 3, 18, 0.72)\")\n      .style(\"stroke-width\", \"2.0px\")\n      .style(\"stroke-linejoin\", \"round\");\n\n    const yAxis = svg.append(\"g\")\n      .call(d3.axisLeft(y).tickSizeOuter(0));\n\n    yAxis.selectAll(\"path, line\").attr(\"stroke\", \"rgba(50, 167, 255, 0.26)\");\n    yAxis.selectAll(\"text\")\n      .attr(\"fill\", axisColor)\n      .style(\"font-size\", \"12px\")\n      .style(\"paint-order\", \"stroke\")\n      .style(\"stroke\", \"rgba(7, 3, 18, 0.72)\")\n      .style(\"stroke-width\", \"2.0px\")\n      .style(\"stroke-linejoin\", \"round\");\n\n    // === âœ… é¢œè‰²ï¼šèµ›åšéœ“è™¹æ¸å˜ï¼ˆä¸ 3D ä¸€è‡´ï¼‰ ===\n    const vMin = d3.min(heatmapData, d => d.value);\n    const vMax = d3.max(heatmapData, d => d.value);\n\n    // âœ… é¢œè‰²ï¼šæŒ‰æˆªå›¾çš„éœ“è™¹æ¸å˜ï¼ˆæ·±ç´« â†’ ç´« â†’ é’ â†’ ç²‰ â†’ è¿‘ç™½ï¼‰\n    const cyberStops = getCyberStops();\n    const cyberInterpolator = d3.interpolateRgbBasis(cyberStops);\n\n    const colorScale = d3.scaleSequential()\n      .domain([vMin, vMax])\n      .interpolator(cyberInterpolator);\n\n    // === é¢œè‰²æ˜ å°„å›¾ä¾‹ï¼ˆ2D/3D å…±ç”¨å®¹å™¨ï¼‰===\n    (function updateLegend() {\n      const legend = document.getElementById(\"heatmap-color-legend\");\n      if (!legend) return;\n      const fmt = d3.format(\",d\");\n      legend.innerHTML = `\n        <div class=\"legend-title\">Score â†’ Color</div>\n        <div class=\"legend-bar\" style=\"background: linear-gradient(90deg, ${cyberStops.join(\",\")});\"></div>\n        <div class=\"legend-labels\">\n          <span>${fmt(vMin ?? 0)}</span>\n          <span>${fmt(vMax ?? 0)}</span>\n        </div>\n      `;\n    })();\n\n    // === Tooltipï¼ˆ2D/3D å¤ç”¨åŒä¸€ä¸ªï¼‰===\n    let tooltip = d3.select(\"body\").select(\".heatmap-tooltip\");\n    if (tooltip.empty()) {\n      tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"heatmap-tooltip\");\n    }\n    tooltip\n      .style(\"position\", \"fixed\")\n      .style(\"pointer-events\", \"none\")\n      .style(\"opacity\", 0)\n      .style(\"padding\", \"10px 12px\")\n      .style(\"border-radius\", \"12px\")\n      .style(\"background\", \"rgba(30,41,59,0.92)\")\n      .style(\"color\", \"#fff\")\n      .style(\"font\", '13px/1.35 system-ui,-apple-system,\"Segoe UI\",\"Microsoft YaHei\",sans-serif')\n      .style(\"box-shadow\", \"0 10px 24px rgba(0,0,0,0.16)\")\n      .style(\"z-index\", 1000);\n\n    // === Heatmap cellsï¼ˆä»…ä¿ç•™æ–¹å—ï¼Œæ— ä»»ä½•æŠ˜çº¿/ç‚¹/å…‰æ™•ï¼‰===\n    svg.selectAll(\"rect.cell\")\n      .data(heatmapData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"cell\")\n      // âœ… é‡è¦ï¼šæŠŠæ•°æ®å†™è¿› DOM å±æ€§ï¼Œä¾¿äº `svg-interaction.js` å¤åˆ¶åˆ°æ–°çª—å£å¤§å›¾åç»§ç»­å¯äº¤äº’\n      .attr(\"data-genre\", d => d.genre)\n      .attr(\"data-month\", d => d.month)\n      .attr(\"data-value\", d => d.value)\n      .attr(\"x\", d => x(d.month))\n      .attr(\"y\", d => y(d.genre))\n      .attr(\"width\", x.bandwidth())\n      .attr(\"height\", y.bandwidth())\n      .attr(\"rx\", 8)\n      .attr(\"ry\", 8)\n      .attr(\"fill\", d => colorScale(d.value))\n      .attr(\"stroke\", gridColor)\n      .attr(\"stroke-width\", 1)\n      .on(\"mousemove\", (event, d) => {\n        tooltip.style(\"opacity\", 1).html(`<b>${d.genre}</b><br/>${d.month}<br/>Value: ${d.value}`);\n        const cx = (event && typeof event.clientX === \"number\") ? event.clientX : (event && typeof event.pageX === \"number\" ? event.pageX : 0);\n        const cy = (event && typeof event.clientY === \"number\") ? event.clientY : (event && typeof event.pageY === \"number\" ? event.pageY : 0);\n        const node = tooltip.node();\n        const w = node ? (node.offsetWidth || 0) : 0;\n        const h = node ? (node.offsetHeight || 0) : 0;\n        const pad = 10;\n        let tx = cx + 12;\n        let ty = cy - 18;\n        tx = Math.max(pad, Math.min(tx, (window.innerWidth || 0) - w - pad));\n        ty = Math.max(pad, Math.min(ty, (window.innerHeight || 0) - h - pad));\n        tooltip.style(\"left\", `${tx}px`).style(\"top\", `${ty}px`);\n      })\n      .on(\"mouseout\", () => tooltip.style(\"opacity\", 0));\n\n    console.log(\"âœ… 2D Heatmap rendered (pure heatmap, trend lines removed)\");\n  };\n  \n  // å¯¼å‡ºåˆå§‹åŒ–å‡½æ•°ï¼Œå…è®¸å¤–éƒ¨è°ƒç”¨\n  window.init2DHeatmap = init2DHeatmap;\n  \n  // ç­‰å¾…å®¹å™¨æœ‰å°ºå¯¸åå†æ‰§è¡Œï¼ˆè‹¥å®¹å™¨éšè—åˆ™ä½¿ç”¨é»˜è®¤å°ºå¯¸ç»§ç»­ï¼‰\n  const waitForContainer = () => {\n    const container = document.getElementById(\"heatmap-2d\") || document.getElementById(\"heatmap\");\n    if (!container) {\n      console.error('âŒ æ‰¾ä¸åˆ°heatmapå®¹å™¨');\n      return;\n    }\n    const width = container.offsetWidth || container.clientWidth;\n    const height = container.offsetHeight || container.clientHeight;\n    if (width > 0 && height > 0) {\n      init2DHeatmap();\n    } else if (container.style.display === 'none') {\n      console.log('âš ï¸ å®¹å™¨è¢«éšè—ï¼Œä½¿ç”¨é»˜è®¤å°ºå¯¸ç»§ç»­');\n      init2DHeatmap();\n    } else {\n      setTimeout(waitForContainer, 100);\n    }\n  };\n  \n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      setTimeout(waitForContainer, 100);\n    });\n  } else {\n    setTimeout(waitForContainer, 100);\n  }\n})();\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] âœ¨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] ğŸš¨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">ğŸš¨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}